(function(e){
	function u(u){
		function c(){
			function h(e){
				e.show();
				n.removeClass("loading");
				//$(".content").css({"width":"1000px","height":"600px","margin-left":"auto","margin-right":"auto"});
				//$(".content").append("<div class=commentInfor>lll</div>");
			}
			var t=e(this),r=parseInt(n.css("borderLeftWidth")),i=s-r*2,u=o-r*2,a=t.width(),f=t.height();
			if(a==n.width()&&a<=i&&f==n.height()&&f<=u){
				h(t);
				return
			}
			if(a>i||f>u){
				var l=u<f?u:f,c=i<a?i:a;
				if(l/f<=c/a){
					t.width(a*l/f);
					t.height(l)
				}
				else{
					t.width(c);
					t.height(f*c/a)
				}
			}
			n.animate(
					{
						width:t.width(),
						height:t.height(),
						marginTop:-(t.height()/2)-r,
						marginLeft:-(t.width()/2)-r},200,function(){h(t)})
					}
		if(u)u.preventDefault();
		var a=e(this),f=a.attr("href");
		if(!f)return;
		var l=e(new Image).hide();
		e("#zoom .previous, #zoom .next").show();
		if(a.hasClass("zoom"))e("#zoom .previous, #zoom .next").hide();if(!r){r=true;t.show();
		e("body").addClass("zoomed")}n.html(l).delay(500).addClass("loading");
		l.load(c).attr("src",f);i=a}function a(){var t=i.parent("li").prev();
		if(t.length==0)t=e(".gallery li:last-child");
		t.find("a").trigger("click")}
		function f(){
			var t=i.parent("li").next();
			if(t.length==0)t=e(".gallery li:first-child");
			t.children("a").trigger("click")}
		function l(s){
			if(s)s.preventDefault();
			r=false;i=null;
			t.hide();
			e("body").removeClass("zoomed");
			n.empty()
		}
		function c(){
			/*原photos中comment实现的整体html：
			 * <div class="comment-container">
									<div class="single-comment-title">
										<span class="comment">评论 <span class="comment-num">(1)</span>
										</span>
										<span class="view">浏览 <span class="view-num">(7)</span>
										</span>
										<span class="arr"></span>
									</div>
									<div class="single-comment-more" style="display: none;">
										<a href="#" class="more"> <span class="arr"></span>点击查看较早评论
										</a>
									</div>
									<div class="single-comment-list" style="display: block">
										<ol id="commentList">
											${sessionScope.comments}
										</ol>
									</div>
									<div class="single-comment-submit">
										<div class="single-comment-submit-input">
											<textarea id="add-comment" rows="2" class=""
												placeholder="我也说一句"></textarea>
											<label for="add-comment" class="">
												<em>0</em>/150
											</label>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input  type="button" id="addComment" value="发表"/>"
										</div>
										<div class="single-comment-submit-vcode"
											style="display: none;">
										</div>
									</div>
								</div>
					temp为转移后的代码：		
					var temp="<div class=\"comment-container\"><div class=\"single-comment-title\"><span class=\"comment\">评论 <span class=\"comment-num\">" +
					"(1)</span></span><span class=\"view\">浏览 <span class=\"view-num\">(7)</span></span><span class=\"arr\"></span></div>" +
					"<div class=\"single-comment-more\" style=\"display: none;\"><a href=\"#\" class=\"more\"> <span class=\"arr\"></span>点击查看较早评论" +
					"</a></div><div class=\"single-comment-list\" style=\"display: block\"><ol id=\"commentList\">${sessionScope.comments}</ol>" +
					"</div><div class=\"single-comment-submit\"><div class=\"single-comment-submit-input\"><textarea id=\"add-comment\" rows=\"2\" class=\"\"" +
					" placeholder=\"我也说一句\"></textarea><label for=\"add-comment\" class=\"\"><em>0</em>/150</label><input  " +
					"type=\"button\" id=\"addComment\" value=\"发表\"/></div><div class=\"single-comment-submit-vcode\" style=\"display: none;\">" +
					"</div></div></div>";
					
					注意：comment.js上有几个方法绑定(包括增加评论 删除评论 显示大图【应该已经不需要了】）
					      css里面有部分修改（针对之前的页面）
					      里面的$如何取你跟我说过然而我没理解所以当初写在jsp里现在写在就js里你自己改改…………
			 */
			var temp="<div class=\"comment-container\"><div class=\"single-comment-title\"><span class=\"comment\">评论 <span class=\"comment-num\">" +
			"(1)</span></span><span class=\"view\">浏览 <span class=\"view-num\">(7)</span></span><span class=\"arr\"></span></div>" +
			"<div class=\"single-comment-more\" style=\"display: none;\"><a href=\"#\" class=\"more\"> <span class=\"arr\"></span>点击查看较早评论" +
			"</a></div><div class=\"single-comment-list\" style=\"display: block\"><ol id=\"commentList\">" +
			"${sessionScope.comments}" +//alert!!!!
			"</ol></div><div class=\"single-comment-submit\"><div class=\"single-comment-submit-input\"><textarea id=\"add-comment\" rows=\"2\" class=\"\"" +
			" placeholder=\"我也说一句\"></textarea><label for=\"add-comment\" class=\"\"><em>0</em>/150</label><input  " +
			"type=\"button\" id=\"addComment\" value=\"发表\"/></div><div class=\"single-comment-submit-vcode\" style=\"display: none;\">" +
			"</div></div></div>";
			s=e(window).width();
			//里面commentContent我不知道能不能直接用+temp+不能的话直接粘上面temp里代码
			o=e(window).height()}e("body").append('<div id="zoom"><a class="close"></a><a href="#previous" class="previous"></a><a href="#next" class="next"></a><div class=showContent><div class="img"><div class="content loading"></div></div><div class=commentContent>"+temp+"</div></div></div>');
			var t=e("#zoom").hide(),n=e("#zoom .content"),r=false,i=null,s=e(window).width(),o=e(window).height();
			(function(){t.on("click",function(t){t.preventDefault();if(e(t.target).attr("id")=="zoom")l()});
			e("#zoom .close").on("click",l);e("#zoom .previous").on("click",a);e("#zoom .next").on("click",f);
			e(document).keydown(function(e){if(!i)return;
			if(e.which==38||e.which==40)e.preventDefault();
			if(e.which==27)l();if(e.which==37&&!i.hasClass("zoom"))a();
			if(e.which==39&&!i.hasClass("zoom"))f()});
			if(e(".gallery li a").length==1)e(".gallery li a")[0].addClass("zoom");
			e(".zoom, .gallery li a").on("click",u)})();
			(function(){e(window).on("resize",c)})();
			(function(){e(window).on("mousewheel DOMMouseScroll",function(e){if(!i)return;e.stopPropagation();
			e.preventDefault();
			e.cancelBubble=false})})()})(jQuery);
